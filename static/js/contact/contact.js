$(document).ready(function () {
    var varContct = { ID: 0, Name: "", City: "", Number: "", Email: "", Message: "", Website: "" }
    $("#submitContactDetail").bind("click", function () { var valid = $("#formContact").validationEngine('validate'); if (valid) { varContct.Name = $('#name').val(); varContct.City = $('#city').val(); varContct.Number = $('#number').val(); varContct.Email = $('#email').val(); varContct.Message = $('#message').val(); varContct.Website = $('#website').val(); var data = JSON.stringify(varContct); ServerRequest(MethodName.SaveContact, data, OnSuccessContact, OnErrorContact); } else { $("#formContact").validationEngine(); } return false; });
}); function OnSuccessContact(result) { switch (result.SingleResult) { case ResultCode.Success: BootstrapDialog.show({ title: 'Thank you', message: 'Thank you for contacting us. We will reach out to you shortly.', closable: false, buttons: [{ label: 'OK', action: function (dialogRef) { dialogRef.close(); } }] }); $('#formContact')[0].reset(); break; case ResultCode.AlreadyExist: BootstrapDialog.show({ title: 'Already exists', message: 'You have already filled this form.', closable: false, buttons: [{ label: 'OK', action: function (dialogRef) { dialogRef.close(); } }] }); break; case ResultCode.Error: BootstrapDialog.show({ title: 'Error', message: 'There is some error in contact form submission.', closable: false, buttons: [{ label: 'OK', action: function (dialogRef) { dialogRef.close(); } }] }); break; case ResultCode.EmailSendFailed: BootstrapDialog.show({ title: 'Information', message: 'There is some error in email send.', closable: false, buttons: [{ label: 'OK', action: function (dialogRef) { dialogRef.close(); } }] }); break; } } function OnErrorContact(error) { BootstrapDialog.show({ title: 'Error', message: error, closable: false, buttons: [{ label: 'OK', action: function (dialogRef) { dialogRef.close(); } }] }); }